#include "PostExploitation.hpp"
#include "WindowsException.hpp"

namespace PostExploitation
{

void pop_shell()
{
	STARTUPINFOW startup_info = {};
	PROCESS_INFORMATION process_information = {};
	BOOL create_shell_result = CreateProcessW(L"C:\\Windows\\System32\\cmd.exe",
		nullptr,
		nullptr,
		nullptr,
		FALSE,
		NULL,
		nullptr,
		nullptr,
		&startup_info,
		&process_information);
	if (create_shell_result == FALSE)
	{
		throw WindowsException(ArcaneErrors::ErrorCodes::CreateProcessFailed);
	}
}

}